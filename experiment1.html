<!DOCTYPE html>
<html>
  <head>
    <title>My experiment</title>
    <script src="https://unpkg.com/jspsych@7.2.3"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.1"></script>
 <script src="https://unpkg.com/@jspsych/plugin-survey-text"></script>
  <script src="https://unpkg.com/@jspsych/plugin-survey-html-form"></script>
    <link href="https://unpkg.com/jspsych@7.2.3/css/jspsych.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="mystyle.css">
  </head>
  <body></body>
  <script>


    var regexes = ['[a-z]+$', '[A-Za-z0-9]*[a-z][A-Za-z0-9]*$']

  	var jsPsych = initJsPsych({

    on_data_update: function(data) {
    console.log('Just added new data. The contents of the data are: '+JSON.stringify(data));
    console.log(JSON.stringify(data).description)
    change_color()
  }
      });
  	var timeline = [];
    var counter = -2;
  	var welcome = {
  	type: jsPsychHtmlKeyboardResponse,
  	stimulus: `<p> Welcome to the regular expressions experiment!</p>
  	 <p> Press any key to begin. </p> `
	};
	 var instructions = {
  	type: jsPsychHtmlKeyboardResponse,
  	stimulus: `
    <p>In this experiment, you will be shown descritpions of different groups of strings. </p>
  	<p> Ex: All strings that start with "a", all strings that contain one capital letter etc.. </p>
    <p> <strong> For each description your goal is to provide examples of the strings that fit the descirption and allow someone
    who has never seen the description to guess it. </strong> </p>
    <p>Please type in examples seperated by commas; you may provide as many or as little examples as you wish.</p>
    <p>Press any key to begin.</p>,`,
};

var trial1 = {
  type: jsPsychSurveyHtmlForm,
  preamble: 'Provide up to 20 examples of strings that will allow someone to guess the description below. Feel free to provide as many or as few examples as you think are needed to guess the description <br> <br> <stong> Descritpion </strong>: All non empty lowercase strings <br> <stong>  Corresponding Regex </strong>: [a-z]+' ,
  html: '<p> <br> Example 1: <input name="first" type="text" class="wrong" class = "example"/> <br> Example 2: <input name="second" class="wrong" type="text" id = "example" /> <br> Example 3: <input name="third" type="text" class="wrong" id = "example" /> <br> Example 4: <input name="second" class="wrong" type="text" id = "example" /> <br> Example 5: <input name="second" class="wrong" type="text" id = "example" /> <br> Example 6: <input name="second" class="wrong" type="text" id = "example" /><br> Example 7: <input name="second" class="wrong" type="text" id = "example" /><br> Example 8: <input name="second" class="wrong" type="text" id = "example" /><br> Example 9: <input name="second" class="wrong" type="text" id = "example" /><br> Example 10: <input name="second" class="wrong" type="text" id = "example" /><br> Example 11: <input name="second" class="wrong" type="text" id = "example" /><br> Example 12: <input name="second" class="wrong" type="text" id = "example" /><br> Example 13: <input name="second" class="wrong" type="text" id = "example" /><br> Example 14: <input name="second" class="wrong" type="text" id = "example" /><br> Example 14: <input name="second" class="wrong" type="text" id = "example" />   <br> Example 15: <input name="second" class="wrong" type="text" id = "example" />  <br> Example 16: <input name="second" class="wrong" type="text" id = "example" />  <br> Example 17: <input name="second" class="wrong" type="text" id = "example" /> <br> Example 18: <input name="second" class="wrong" type="text" id = "example" /> <br> Example 19: <input name="second" class="wrong" type="text" id = "example" /> <br> Example 20: <input name="second" class="wrong" type="text" id = "example" /> </p>',
  description: '[a-z]+$',
  on_start: console.log("hi")
};

async function change_color(){

  console.log("hi")
  counter = counter +1 
  console.log(counter)
  setTimeout(function(){
  var re = new RegExp(regexes[counter]);
  var els = document.getElementsByTagName('input');
  console.log(els)
  if (els.length >1 ) {
        console.log("Trial Started")
        console.log(els)
        console.log(els.length)
        for (var i = 0; i < els.length-1; i++) {
          console.log("DEBUG")
          var cell = els[i];
          cell.addEventListener('change', (e) => {  
          console.log(e.target.value)
          console.log(e.target)
          //console.log(e.target.style.color)
          //e.target.classList.remove('correct')
          //e.traget.classList.remove('wrong')
          if ( re.test(e.target.value)) {
            e.target.classList.add("correct") 
        } else {
          console.log(e.target.classList[1])
          if (e.target.classList[1] == "correct"){
            e.target.classList.remove('correct')

            } 
        } })
      }
  }
  }, 500); 
 }

	timeline.push(welcome);
	timeline.push(instructions);
	timeline.push(trial1);
	
	jsPsych.run(timeline);
  </script>
</html>